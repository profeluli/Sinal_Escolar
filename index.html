<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sinal Escolar</title>
    <script>
        let horarios = {
            "segunda": ["07:20", "08:10", "09:00", "09:15", "10:05", "10:55", "11:45", "12:35", "12:55", "13:45", "14:35", "15:25", "15:40", "16:30", "17:20"],
            "terca": ["07:20", "08:10", "09:00", "09:15", "10:05", "10:55", "11:45", "12:35", "12:55", "13:45", "14:35", "15:25", "15:40", "16:30", "17:20"],
            "quarta": ["07:20", "08:10", "09:00", "09:15", "10:05", "10:55", "11:45", "12:35", "12:55", "13:45", "14:35", "15:25", "15:40", "16:30", "17:20"],
            "quinta": ["07:20", "08:10", "09:00", "09:15", "10:05", "10:55", "11:45", "12:35", "12:55", "13:45", "14:35", "15:25", "15:40", "16:30", "17:20"],
            "sexta": ["07:20", "08:10", "09:00", "09:15", "10:05", "10:55", "11:45", "12:35", "12:55", "13:45", "14:35", "15:25", "15:40", "16:30", "17:20"]
        };
        let audioFile = null;
        let sincronizarHorario = false;

        window.onload = function() {
            let horariosSalvos = localStorage.getItem('horarios');
            if (horariosSalvos) {
                horarios = JSON.parse(horariosSalvos);
            } else {
                localStorage.setItem('horarios', JSON.stringify(horarios));
            }
            atualizarListaHorarios();
        };

        function atualizarListaHorarios() {
            let lista = document.getElementById("listaHorarios");
            lista.innerHTML = "";
            for (let dia in horarios) {
                let item = document.createElement("li");
                item.textContent = `${dia.charAt(0).toUpperCase() + dia.slice(1)}: ${horarios[dia].join(" - ")}`;
                lista.appendChild(item);
            }
        }

        function tocarSinal() {
            if (audioFile) {
                let audio = new Audio(audioFile);
                audio.play();
            } else {
                alert('Por favor, selecione um arquivo de áudio primeiro.');
            }
        }

        function verificarHorario() {
            if (!sincronizarHorario) return;
            
            let agora = new Date();
            let diaSemana = ['domingo', 'segunda', 'terca', 'quarta', 'quinta', 'sexta', 'sabado'][agora.getDay()];
            let horarioAtual = agora.getHours().toString().padStart(2, '0') + ':' + agora.getMinutes().toString().padStart(2, '0');

            if (horarios[diaSemana] && horarios[diaSemana].includes(horarioAtual)) {
                tocarSinal();
            }
        }

        function carregarAudio(event) {
            let file = event.target.files[0];
            if (file) {
                audioFile = URL.createObjectURL(file);
                alert('Arquivo de áudio carregado com sucesso!');
            }
        }

        function alternarSincronizacao() {
            sincronizarHorario = document.getElementById('sincronizarCheckbox').checked;
        }

        setInterval(verificarHorario, 60000);
    </script>
</head>
<body>
    <h1>Sinal Escolar Automático</h1>
    <p>O sinal será tocado nos horários programados automaticamente.</p>
    
    <label>
        <input type="checkbox" id="sincronizarCheckbox" onclick="alternarSincronizacao()"> Sincronizar com horário do sistema
    </label>
    <br><br>

    <h2>Horários Programados:</h2>
    <ul id="listaHorarios"></ul>

    <input type="file" accept="audio/mp3" onchange="carregarAudio(event)">
    <br>
    <button onclick="tocarSinal()">Tocar Sinal Manualmente</button>
</body>
</html>
